(()=>{var t={7757:(t,e,n)=>{t.exports=n(5666)},5666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,a=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,a){var r=e&&e.prototype instanceof v?e:v,o=Object.create(r.prototype),i=new A(a||[]);return o._invoke=function(t,e,n){var a=u;return function(r,o){if(a===p)throw new Error("Generator is already running");if(a===f){if("throw"===r)throw o;return j()}for(n.method=r,n.arg=o;;){var i=n.delegate;if(i){var c=L(i,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===u)throw a=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=p;var s=d(t,e,n);if("normal"===s.type){if(a=n.done?f:m,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(a=f,n.method="throw",n.arg=s.arg)}}}(t,n,i),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u="suspendedStart",m="suspendedYield",p="executing",f="completed",h={};function v(){}function b(){}function g(){}var y={};s(y,o,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==n&&a.call(k,o)&&(y=k);var x=g.prototype=v.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(r,o,i,c){var s=d(t[r],t,o);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(s.arg)}var r;this._invoke=function(t,a){function o(){return new e((function(e,r){n(t,a,e,r)}))}return r=r?r.then(o,o):o()}}function L(t,n){var a=t.iterator[n.method];if(a===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,L(t,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=d(a,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,h;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function q(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function O(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function n(){for(;++r<t.length;)if(a.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}return{next:j}}function j(){return{value:e,done:!0}}return b.prototype=g,s(x,"constructor",g),s(g,"constructor",b),b.displayName=s(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},_(S.prototype),s(S.prototype,i,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,a,r,o){void 0===o&&(o=Promise);var i=new S(l(e,n,a,r),o);return t.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(x),s(x,c,"Generator"),s(x,o,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var a=e.pop();if(a in t)return n.value=a,n.done=!1,n}return n.done=!0,n}},t.values=O,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(q),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(a,r){return c.type="throw",c.arg=t,n.next=a,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),q(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;q(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:O(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),h}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var o=e[a]={exports:{}};return t[a](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),window.onload=function(){$("div.alert").delay(4e3).fadeOut(350),[].slice.call(document.querySelectorAll("[data-bs-toggle='tooltip']")).map((function(t){return new bootstrap.Tooltip(t,{html:!0})})),[].slice.call(document.querySelectorAll("[data-bs-toggle='popover']")).map((function(t){return new bootstrap.Popover(t,{})}))},window.SPMaskBehavior=function(t){return 11===t.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"},spOptions={onKeyPress:function(t,e,n,a){n.mask(SPMaskBehavior.apply({},arguments),a)}},window.isInvalidText=function(t,e){var n=$(t).val(),a=!1;return null===n||n.length<e?(a=!0,$(t).addClass("is-invalid")):$(t).removeClass("is-invalid"),a},window.isInvalidNumber=function(t,e){var n=$(t).val(),a=!1;try{n=parseFloat(n)}catch(e){return a=!0,$(t).addClass("is-invalid"),a}return n<=e||isNaN(n)?(a=!0,$(t).addClass("is-invalid")):$(t).removeClass("is-invalid"),a},window.isValidInput=function(t,e){return $(t).val()&&$(t).val().length>=e?($(t).removeClass("is-invalid"),!0):($(t).addClass("is-invalid"),!1)},window.isValidCEP=function(t){return $(t).val()&&$(t).val().length==="00000-000".length?($(t).removeClass("is-invalid"),!0):($(t).addClass("is-invalid"),!1)},window.convertHex=function(t,e){var n=t.replace("#","");return 3===n.length&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),"rgba("+parseInt(n.substring(0,2),16)+","+parseInt(n.substring(2,4),16)+","+parseInt(n.substring(4,6),16)+","+e/100+")"},(()=>{"use strict";var t=n(7757),e=n.n(t);function a(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function o(t,e,n,a,r,o,i){try{var c=t[o](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(a,r)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function c(t){o(i,a,r,c,s,"next",t)}function s(t){o(i,a,r,c,s,"throw",t)}c(void 0)}))}}function c(){null!==document.querySelector(".is-invalid")&&document.querySelector(".is-invalid").focus()}function s(t,e){e?(t.classList.add("is-valid"),t.classList.remove("is-invalid")):(t.classList.add("is-invalid"),t.classList.remove("is-valid"))}function l(t,e){e?(t.classList.add("valid-feedback"),t.classList.remove("invalid-feedback"),t.style.display="block"):(t.classList.add("invalid-feedback"),t.classList.remove("valid-feedback"),t.style.display="block")}window.clearCommentSection=function(){var t=document.querySelector("#ticket-comments-responsibles"),e=document.querySelector("#ticket-feedback-comments-responsibles-edit"),n=document.querySelector("#ticket-comments-text"),a=document.querySelector("#ticket-feedback-comments-text-edit");t.selectedIndex=0,n.value="",t.classList.remove("is-valid","is-invalid"),e.classList.remove("is-valid","is-invalid"),e.innerText="",n.classList.remove("is-valid","is-invalid"),a.classList.remove("is-valid","is-invalid"),a.innerText=""},window.clearAttachmentSection=function(){var t=document.querySelector("#ticket-attachment"),e=document.querySelector("#ticket-feedback-attachment-edit"),n=document.querySelector("#btn-update-ticket-attachment");t.value="",t.classList.remove("is-valid","is-invalid"),e.classList.remove("is-valid","is-invalid"),e.innerText="",n.setAttribute("disabled",!0)},window.enableEditTicketField=function(t){var e=t.id.split("-")[3],n=document.querySelector("#ticket-".concat(e)),a=document.querySelector("#btn-cancel-ticket-".concat(e)),r=document.querySelector("#btn-update-ticket-".concat(e));n.removeAttribute("disabled"),t.classList.add("d-none"),a.classList.remove("d-none"),r.classList.remove("d-none")},window.cancelEditTicketField=function(t){var e=t.id.split("-")[3],n=document.querySelector("#ticket-".concat(e)),a=document.querySelector("#ticket-feedback-".concat(e,"-edit")),r=document.querySelector("#btn-edit-ticket-".concat(e)),o=document.querySelector("#btn-update-ticket-".concat(e));n.value="title"===e?ticketTitle:"description"===e?ticketDescription:"",n.classList.remove("is-valid","is-invalid"),a.style.display="none",n.setAttribute("disabled",!0),t.classList.add("d-none"),r.classList.remove("d-none"),o.classList.add("d-none")},window.enableSubmitButton=function(t){var e=t.id.split("-")[1],n=document.querySelector("#btn-update-ticket-".concat(e));if("deadline"===e)window.validateTicketDeadline(t)?n.removeAttribute("disabled"):n.setAttribute("disabled",!0);else if("attachment"===e){window.validateFile(t)?n.removeAttribute("disabled"):n.setAttribute("disabled",!0)}else n.removeAttribute("disabled")},window.validateInput=function(t,e){var n=t.closest(".form-group").lastElementChild;return 0===t.value.length?(n.innerText="Preencha o campo.",s(t,!1),l(n,!1),!1):t.value.length<e?(n.innerText="Mínimo de ".concat(e,1===e?" caractere.":" caracteres."),s(t,!1),l(n,!1),!1):(n.innerText="Formato aceito.",s(t,!0),l(n,!0),!0)},window.validateTextarea=function(t,e,n){var a=t.closest(".form-group").lastElementChild;return 0===t.value.length?(a.innerText="Preencha o campo.",s(t,!1),l(a,!1),!1):t.value.length<e?(a.innerText="Mínimo de ".concat(e,1===e?" caractere.":" caracteres."),s(t,!1),l(a,!1),!1):t.value.length>n?(a.innerText="Máximo de ".concat(n," caracteres."),s(t,!1),l(a,!1),!1):(a.innerText="Formato aceito.",s(t,!0),l(a,!0),!0)},window.validateSelect=function(t){var e=t.closest(".form-group").lastElementChild;return t.hasAttribute("required")?0===t.selectedIndex?(e.innerText="Escolha uma opção.",s(t,!1),l(e,!1),!1):(e.innerText="Formato aceito.",s(t,!0),l(e,!0),!0):(e.innerText="Formato aceito",s(t,!0),l(e,!0),!0)},window.validateTicketDeadline=function(t){var e=document.querySelector("#ticket-feedback-deadline-edit"),n=t.value,a=function(t,e){var n=1==(t=new Date(parseInt(t))).getDate().toString().length?"0"+t.getDate().toString():t.getDate().toString(),a=parseInt(t.getMonth())+1;a=1==a.toString().length?"0"+a.toString():a.toString();var r=t.getFullYear();t="en-us"===e?"".concat(r,"-").concat(a,"-").concat(n):"".concat(n,"/").concat(a,"/").concat(r);return t}(Date.now(),"en-us");return n.split("-").length<3?(e.innerText="Formato inválido.",s(t,!1),l(e,!1),!1):n.split("-")[0].length>4?(e.innerText="O ano deve ter no máximo 4 dígitos.",s(t,!1),l(e,!1),!1):n<a?(e.innerText="O Prazo deve ser igual ou maior a data de hoje.",s(t,!1),l(e,!1),!1):n.length<8?(e.innerText="Mínimo de ".concat(8," caracteres."),s(t,!1),l(e,!1),!1):(e.innerText="Formato aceito.",s(t,!0),l(e,!0),!0)},window.validateFile=function(t){var e=t.closest(".form-group").lastElementChild;return void 0!==t.files[0]&&-1==["application/pdf","image/jpeg","image/png"].indexOf(t.files[0].type)?(e.innerHTML='O arquivo <span class="fw-bold">"'.concat(t.files[0].name,'"</span> não é permitido.'),s(t,!1),l(e,!1),!1):void 0!==t.files[0]&&t.files[0].size>10485760?(e.innerHTML='O arquivo <span class="fw-bold">"'.concat(t.files[0].name,'"</span> ultrapassa o limite de 10 MB.'),s(t,!1),l(e,!1),!1):(e.innerText="Formato aceito.",s(t,!0),l(e,!0),!0)},window.updateTicket=function(){var t=i(e().mark((function t(n){var r,o,i,s,l,d,u,m,p,f,h,v,b,g,y,w,k,x,_,S,L,T,q,A,O,j,E,M,C,F,I,P,N,H,D,z,G;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,o=n.id.split("-")[3],i=document.querySelector("#ticket-id"),s=document.querySelector("#ticket-".concat(o)),l=document.querySelector("#ticket-feedback-".concat(o,"-edit")),d=document.querySelector("#btn-edit-ticket-".concat(o)),u=document.querySelector("#btn-cancel-ticket-".concat(o)),m=document.querySelector("#btn-ticket-".concat(o,"-updated")),p=document.querySelector("#".concat(n.id," i")),f=document.querySelector("#btn-update-ticket-".concat(o,"-loading")),h=document.querySelector("#ticket-log-card"),v=document.querySelector("#ticket-log"),b=document.querySelector("#ticket-log-empty"),t.t0=o,t.next="title"===t.t0?16:"status"===t.t0?18:"description"===t.t0?20:"deadline"===t.t0?22:"responsibles"===t.t0?24:26;break;case 16:return g=!!window.validateInput(s,2),t.abrupt("break",26);case 18:return g=!!window.validateSelect(s),t.abrupt("break",26);case 20:return g=!!window.validateInput(s,2),t.abrupt("break",26);case 22:return g=!!window.validateTicketDeadline(s),t.abrupt("break",26);case 24:return g=!!window.validateSelect(s),t.abrupt("break",26);case 26:if(g||(r=!1),c(),!r){t.next=44;break}if(n.setAttribute("disabled",!0),"title"!==o&&"description"!==o||u.setAttribute("disabled",!0),p.classList.add("d-none"),f.classList.remove("d-none"),b&&b.classList.add("d-none"),y=[],"responsibles"===o){for(x=0;x<s.options.length;x++)s.options[x].selected&&y.push(s.options[x].value);w=y,_=window.location.href,S=_.split("/").length-1,L=_.split("/")[S],k="http://erp.sunnyhouse.com.br/tickets/edit/".concat(L)}else k=null,w=s.value;return T={ticket:i.value,type:o,field:w,url:k},t.next=39,fetch(url_tickets_update,{method:"POST",headers:{"X-CSRF-TOKEN":$("meta[name='csrf-token']").attr("content"),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(T)});case 39:return q=t.sent,t.next=42,q.json();case 42:if(A=t.sent,q.ok){if(m.style.display="inline-block","title"!==o&&"description"!==o||(n.removeAttribute("disabled"),n.classList.add("d-none"),u.classList.add("d-none"),u.removeAttribute("disabled"),d.classList.remove("d-none"),s.setAttribute("disabled",!0)),p.classList.remove("d-none"),f.classList.add("d-none"),s.classList.remove("is-valid","is-invalid"),l.style.display="none",A.status){if(m.innerText=A.ticket_log.message,m.classList.remove("bg-danger"),m.classList.add("bg-success"),O=document.querySelectorAll("#".concat(v.id," [data-log-item]")),j=0,0===O.length?j=1:(j=O.length+1,h.classList.add("overflow-y-scroll")),"deadline"===A.type)M="".concat(A.ticket_log.new_value.split("-")[2],"/").concat(A.ticket_log.new_value.split("-")[1],"/").concat(A.ticket_log.new_value.split("-")[0]),null===A.ticket_log.old_value?E='&ndash; Atualizado para <span class="text-warning">'.concat(M,"</span>"):(C="".concat(A.ticket_log.old_value.split("-")[2],"/").concat(A.ticket_log.old_value.split("-")[1],"/").concat(A.ticket_log.old_value.split("-")[0]),E='&ndash; Modificado de <span class="text-warning">'.concat(C,'</span> para <span class="text-warning">').concat(M,"</span>"));else if("responsibles"===A.type){for(a((F=document.querySelector("#ticket-responsibles-badge")).children).forEach((function(t){return t.remove()})),I=0;I<=A.responsible_data.length-1;I++)null!=A.responsible_data[I].cellphone?F.insertAdjacentHTML("beforeend",'\n                                <span class="badge bg-brown fw-bold">\n                                    <a href="https://wa.me/55'.concat(A.responsible_data[I].cellphone,"/?text=Olá, ").concat(A.responsible_data[I].name,"! Você foi atribuído(a) a uma OS. Mais informações em ").concat(k,'" target="_blank"\n                                        class="text-white">\n                                        ').concat(A.responsible_data[I].name,'\n                                        <i class="bi bi-whatsapp ms-1"\n                                            role="img" aria-label="WhatsApp"></i>\n                                    </a>\n                                </span>\n                            ')):F.insertAdjacentHTML("beforeend",'\n                                <span class="badge bg-brown fw-bold">\n                                    '.concat(A.responsible_data[I].name,"\n                                </span>\n                            "));if(0===A.ticket_log.old_value.length){for(P="",N=0;N<A.ticket_log.new_value.length;N++)P+="[".concat(A.ticket_log.new_value[N],"] ");E='&ndash; Atualizado para <span class="text-warning">'.concat(P,"</span>")}else{for(H="",D="",z=0;z<A.ticket_log.old_value.length;z++)H+="[".concat(A.ticket_log.old_value[z],"] ");for(G=0;G<A.ticket_log.new_value.length;G++)D+="[".concat(A.ticket_log.new_value[G],"] ");E='&ndash; Modificado de <span class="text-warning">'.concat(H,'</span> para <span class="text-warning">').concat(D,"</span>")}}else E=null===A.ticket_log.old_value?'&ndash; Atualizado para <span class="text-warning">'.concat(A.ticket_log.new_value,"</span>"):'&ndash; Modificado de <span class="text-warning">'.concat(A.ticket_log.old_value,'</span> para <span class="text-warning">').concat(A.ticket_log.new_value,"</span>");v.insertAdjacentHTML("beforeend",'\n                    <li class="rounded mb-3" id="log-new-'.concat(j,'"\n                        data-log-item>\n                        <div class="d-flex w-100 justify-content-between rounded-top bg-light bg-gradient border border-gray p-3 pt-2 pb-2"\n                            id="log-header-').concat(j,'">\n                            <small class="text-primary fw-bold"\n                                id="log-author-').concat(j,'">\n                                ').concat(A.ticket_log.message,'\n                            </small>\n                            <small id="log-data-').concat(j,'">\n                                ').concat(A.ticket_log.created_at,'\n                            </small>\n                        </div>\n                        <div class="border border-gray border-top-0 rounded-bottom p-3"\n                            id="log-text-').concat(j,'">\n                            <p class="mb-0">\n                                <span class="fw-bold">Realizado por:</span> ').concat(A.ticket_log.user,'\n                            </p>\n                            <p class="mb-0">\n                                ').concat(E,"\n                            </p>\n                        </div>\n                    </li>\n                "))}else m.innerText=A.message,m.classList.remove("bg-success"),m.classList.add("bg-danger"),s.value=ticketTitle;$(m).delay(2e3).fadeOut(350)}case 44:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),window.submitTicketComment=i(e().mark((function t(){var n,a,r,o,i,s,l,d,u,m,p,f,h,v,b,g,y,w,k,x,_,S,L,T,q,A,O,j;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!0,a=document.querySelector("#ticket-id"),r=document.querySelector("#ticket-comments-responsibles"),o=document.querySelector("#ticket-comments-text"),i=[],s=document.querySelector("#comments-ticket"),l=document.querySelector("#ticket-comments-card"),d=document.querySelector("#ticket-comments-loading"),u=document.querySelector("#ticket-comments-empty"),m=document.querySelector("#btn-ticket-comment-added"),p=!!window.validateSelect(r),f=!!window.validateTextarea(o,5,250),p||(n=!1),f||(n=!1),c(),!n){t.next=31;break}for(s.classList.add("d-none"),d.classList.remove("d-none"),d.closest(".card-body").classList.remove("d-none"),null!=u&&u.classList.add("d-none"),h=0;h<r.length;h++)r.options[h].selected&&i.push(r.options[h].value);return v=""!==i[0]?i:null,b={ticket:a.value,"comment-responsible":v,"comment-text":o.value},t.next=25,fetch(url_post_ticket_comment,{method:"POST",headers:{"X-CSRF-TOKEN":$("meta[name='csrf-token']").attr("content"),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(b)});case 25:return g=t.sent,t.next=28,g.json();case 28:if(y=t.sent,g.ok){if(m.style.display="inline-block",y.status){if(s.classList.remove("d-none"),d.classList.add("d-none"),m.innerText=y.message,w=document.querySelectorAll("#".concat(s.id," [data-comment-item]")),k=0,x=y.comment_data.date.split(" ")[0],_=y.comment_data.date.split(" ")[1],S="".concat(x.split("-")[2],"/").concat(x.split("-")[1],"/").concat(x.split("-")[0]),0===w.length?k=1:(k=w.length+1,l.classList.add("overflow-y-scroll")),s.insertAdjacentHTML("beforeend",'\n                    <li class="rounded mb-3" id="comment-new-'.concat(k,'"\n                        data-comment-item>\n                        <div class="d-flex w-100 justify-content-between rounded-top bg-light bg-gradient border border-gray p-3 pt-2 pb-2"\n                            id="comment-header-').concat(k,'">\n                            <small class="text-primary fw-bold"\n                                id="comment-author-').concat(k,'">\n                                ').concat(y.comment_data.author,'\n                            </small>\n                            <small id="comment-data-').concat(k,'">\n                                ').concat(S," - ").concat(_,'\n                            </small>\n                        </div>\n                        <p class="border border-gray border-top-0 rounded-bottom p-3 mb-0"\n                            id="comment-text-').concat(k,'">\n                            <span style="margin-right: 3px" class="text-warning"\n                                id="comment-text-responsibles-').concat(k,'"></span>\n                            ').concat(y.comment_data.comment,"\n                        </p>\n                    </li>\n                ")),L=document.querySelector("#comment-text-responsibles-".concat(k)),T=window.location.href,q=T.split("/").length-1,A=T.split("/")[q],O="http://erp.sunnyhouse.com.br/tickets/edit/".concat(A),null!=y.comment_data.responsibles_data)for(j=0;j<=y.comment_data.responsibles_data.length-1;j++)null!=y.comment_data.responsibles_data[j].cellphone?L.insertAdjacentHTML("afterbegin",'\n                                <a href="https://wa.me/55'.concat(y.comment_data.responsibles_data[j].cellphone,"/?text=Olá, ").concat(y.comment_data.responsibles_data[j].name,"! Você foi atribuído(a) a uma OS. Mais informações em ").concat(O,'"\n                                    target="_blank"\n                                    class="text-success">\n                                    [').concat(y.comment_data.responsibles_data[j].name,'\n                                    <i class="bi bi-whatsapp ms-1"\n                                        role="img" aria-label="WhatsApp"></i>]\n                                </a>\n                            ')):L.insertAdjacentHTML("afterbegin","\n                                [".concat(y.comment_data.responsibles_data[j].name,"]\n                            "))}else d.classList.add("d-none"),d.insertAdjacentHTML("afterend",'\n                    <div class="d-flex position-relative justify-content-center">\n                        <span class="position-absolute alert alert-danger alert-dismissible show fade mb-0"\n                            id="alert-ticket">\n                            <strong>'.concat(y.message,'</strong>\n                            <button type="button" class="btn-close" data-bs-dismiss="alert"\n                                style="top: -1 !important;" \n                                aria-label="Close"></button>\n                        </span>\n                    </div>\n                ')),alert=document.querySelector("#alert-ticket"),alert.style.width="350px",alert.style.zIndex="1000",$("span.alert").delay(2e3).fadeOut(350);$(m).delay(2e3).fadeOut(350)}window.clearCommentSection();case 31:case"end":return t.stop()}}),t)}))),window.submitTicketAttachment=i(e().mark((function t(){var n,a,r,o,i,s,l,d,u,m,p,f;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!0,a=document.querySelector("#ticket-attachment-panel"),r=document.querySelector("#ticket-id"),o=document.querySelector("#ticket-attachment"),i=document.querySelector("#attachment-ticket"),s=document.querySelector("#ticket-attachment-loading"),l=document.querySelector("#btn-ticket-attachment-added"),d=new FormData,!!window.validateFile(o)||(n=!1),c(),!n){t.next=25;break}return i.classList.add("d-none"),s.classList.remove("d-none"),s.closest(".card-body").classList.remove("d-none"),d.append("ticket",r.value),d.append("ticket-attachment",o.files[0]),t.next=19,fetch(url_post_ticket_attachment,{method:"POST",headers:{"X-CSRF-TOKEN":$("meta[name='csrf-token']").attr("content")},body:d});case 19:return u=t.sent,t.next=22,u.json();case 22:m=t.sent,u.ok&&(l.style.display="inline-block",m.status?(i.classList.remove("d-none"),s.classList.add("d-none"),l.innerText=m.message,p=document.querySelectorAll("#".concat(i.id," [data-attachment-item]")),f=0,f=0===p.length?1:p.length+1,i.insertAdjacentHTML("beforeend",'\n                    <li class="rounded mb-3" id="comment-new-'.concat(f,'"\n                        data-attachment-item>\n                        <div class="d-flex w-100 justify-content-between rounded-top bg-light bg-gradient border border-gray p-3 pt-2 pb-2"\n                            id="attachment-header-').concat(f,'">\n                            <small class="text-primary fw-bold"\n                                id="attachment-author-').concat(f,'">\n                                ').concat(m.attachment_data.author,'\n                            </small>\n                            <small id="attachment-data-').concat(f,'">\n                                ').concat(m.attachment_data.created_at,'\n                            </small>\n                        </div>\n\n                        <p class="border border-gray border-top-0 rounded-bottom p-3 mb-0"\n                            id="attachment-text-').concat(f,'">\n                            <a href="').concat(m.attachment_data.attachment_url,'" target="_blank">\n                                ').concat(m.attachment_data.attachment_name,"\n                            </a>\n                        </p>\n                    </li>\n                "))):(s.classList.add("d-none"),a.insertAdjacentHTML("afterbegin",'\n                    <div class="d-flex position-relative justify-content-center">\n                        <span class="position-absolute alert alert-danger alert-dismissible show fade mb-0"\n                            id="alert-ticket">\n                            <strong>'.concat(m.message,'</strong>\n                            <button type="button" class="btn-close" data-bs-dismiss="alert"\n                                style="top: -1 !important;" \n                                aria-label="Close"></button>\n                        </span>\n                    </div>\n                ')),alert=document.querySelector("#alert-ticket"),alert.style.width="350px",alert.style.zIndex="1000",$("span.alert").delay(2e3).fadeOut(350)),$(l).delay(2e3).fadeOut(350)),window.clearAttachmentSection();case 25:case"end":return t.stop()}}),t)})))})()})();