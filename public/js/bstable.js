"use strict";class BSTable{constructor(t,n){var e={editableColumns:null,$addButton:null,onEdit:function(){},onBeforeDelete:function(){},onDelete:function(){},onAdd:function(){$("#"+t).find("tbody tr #bEdit").last().click()},advanced:{columnLabel:"Actions",buttonHTML:'<div class="btn-group pull-right">\n                    <button id="bEdit" type="button" class="btn btn-sm btn-default">\n                        <span class="fa fa-edit"></span>\n                    </button>\n                    <button id="bDel" type="button" class="btn btn-sm btn-default">\n                        <span class="fa fa-trash"></span>\n                    </button>\n                    <button id="bAcep" type="button" class="btn btn-sm btn-default" style="display:none;">\n                        <span class="fa fa-check-circle"></span>\n                    </button>\n                    <button id="bCanc" type="button" class="btn btn-sm btn-default" style="display:none;">\n                        <span class="fa fa-times-circle"></span>\n                    </button>\n                </div>'}};this.table=$("#"+t),this.options=$.extend(!0,e,n),this.actionsColumnHTML='<td name="bstable-actions">'+this.options.advanced.buttonHTML+"</td>",null!=this.options.editableColumns&&(this.options.editableColumns=this.options.editableColumns.split(","))}init(){if(this.table.find("thead tr").append('<th name="bstable-actions">'+this.options.advanced.columnLabel+"</th>"),this.table.find("tbody tr").append(this.actionsColumnHTML),this._addOnClickEventsToActions(),null!=this.options.$addButton){let t=this;this.options.$addButton.click((function(){t._actionAddRow()}))}}destroy(){this.table.find('th[name="bstable-actions"]').remove(),this.table.find('td[name="bstable-actions"]').remove()}refresh(){this.destroy(),this.init()}currentlyEditingRow(t){return"editing"==t.attr("data-status")}_actionsModeNormal(t){$(t).parent().find("#bAcep").hide(),$(t).parent().find("#bCanc").hide(),$(t).parent().find("#bEdit").show(),$(t).parent().find("#bDel").show(),$("button[id='bEdit']").show(),$(t).parents("tr").attr("data-status","")}_actionsModeEdit(t){$(t).parent().find("#bAcep").show(),$(t).parent().find("#bCanc").show(),$(t).parent().find("#bEdit").hide(),$(t).parent().find("#bDel").hide(),$("button[id='bEdit']").hide(),$(t).parents("tr").attr("data-status","editing")}_rowEdit(t){let n=$(t).parents("tr"),e=n.find("td");this.currentlyEditingRow(n)||(this._modifyEachColumn(this.options.editableColumns,e,(function(t){let n,i=$("#editable-table").find("tbody tr"),a=t.html(),l='<div style="display: none;">'+a+"</div>",o=Math.random().toString(36).substring(7),d=a?"":"is-invalid";t.css("vertical-align","top"),1===i.length?(n='<input class="form-control input-sm solar-kit" id="'+o+'"data-original-value="'+a+'" value="'+a+'"oninput="window.onEditField(this)"onchange="window.onEditField(this)"autocomplete="off">',t.html(l+n),$(e[0].children[1]).val("Par de Conectores Femea/Macho Staubh MC4"),$(e[0].children[1]).attr("data-original-value","Par de Conectores Femea/Macho Staubh MC4"),$(e[0].children[1]).attr("disabled",!0),$(e[1].children[1]).val("1 KIT"),$(e[1].children[1]).attr("data-original-value","1 KIT"),$(e[1].children[1]).attr("disabled",!0)):2===i.length?(n='<input class="form-control input-sm solar-kit" id="'+o+'"data-original-value="'+a+'" value="'+a+'"oninput="window.onEditField(this)"onchange="window.onEditField(this)"autocomplete="off">',t.html(l+n),"Par de Conectores Femea/Macho Staubh MC4"!==t.parent().prev().children()[0].innerText?($(e[0].children[1]).val("Par de Conectores Femea/Macho Staubh MC4"),$(e[0].children[1]).attr("data-original-value","Par de Conectores Femea/Macho Staubh MC4"),$(e[0].children[1]).attr("disabled",!0),$(e[1].children[1]).val("1 KIT"),$(e[1].children[1]).attr("data-original-value","1 KIT"),$(e[1].children[1]).attr("disabled",!0)):($(e[0].children[1]).val("Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Preto"),$(e[0].children[1]).attr("data-original-value","Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Preto"),$(e[0].children[1]).attr("disabled",!0),$(e[1].children[1]).val("1 KIT"),$(e[1].children[1]).attr("data-original-value","1 KIT"),$(e[1].children[1]).attr("disabled",!0))):3===i.length?(n='<input class="form-control input-sm solar-kit" id="'+o+'"data-original-value="'+a+'" value="'+a+'"oninput="window.onEditField(this)"onchange="window.onEditField(this)"autocomplete="off">',t.html(l+n),"Par de Conectores Femea/Macho Staubh MC4"!==t.parent().prev().children()[0].innerText&&"Par de Conectores Femea/Macho Staubh MC4"!==t.parent().prev().prev().children()[0].innerText?($(e[0].children[1]).val("Par de Conectores Femea/Macho Staubh MC4"),$(e[0].children[1]).attr("data-original-value","Par de Conectores Femea/Macho Staubh MC4"),$(e[0].children[1]).attr("disabled",!0),$(e[1].children[1]).val("1 KIT"),$(e[1].children[1]).attr("data-original-value","1 KIT"),$(e[1].children[1]).attr("disabled",!0)):"Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Preto"!==t.parent().prev().children()[0].innerText&&"Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Preto"!==t.parent().prev().prev().children()[0].innerText?($(e[0].children[1]).val("Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Preto"),$(e[0].children[1]).attr("data-original-value","Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Preto"),$(e[0].children[1]).attr("disabled",!0),$(e[1].children[1]).val("1 KIT"),$(e[1].children[1]).attr("data-original-value","1 KIT"),$(e[1].children[1]).attr("disabled",!0)):($(e[0].children[1]).val("Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Vermelho"),$(e[0].children[1]).attr("data-original-value","Cabo Solar Nexans Energyflex BR 0,6/1kV (1500 V DC) Vermelho"),$(e[0].children[1]).attr("disabled",!0),$(e[1].children[1]).val("1 KIT"),$(e[1].children[1]).attr("data-original-value","1 KIT"),$(e[1].children[1]).attr("disabled",!0))):(n='<input class="form-control input-sm solar-kit '+d+'" id="'+o+'"data-original-value="'+a+'" value="'+a+'"oninput="window.onEditField(this)"onchange="window.onEditField(this)"autocomplete="off">',t.html(l+n),$("#editable-table").find("tbody").prepend(t.parent()))})),this._actionsModeEdit(t))}_rowDelete(t){$("button[id='bEdit']").show();let n=$(t).parents("tr");window.onDeleteRow(n),this.options.onBeforeDelete(n),n.remove(),this.options.onDelete()}_rowAccept(t){let n=$(t).parents("tr"),e=n.find("td");this.currentlyEditingRow(n)&&(this._modifyEachColumn(this.options.editableColumns,e,(function(t){let n=t.find("input").val();t.html(n)})),this._actionsModeNormal(t),this.options.onEdit(n[0]))}_rowCancel(t){$("button[id='bEdit']").show();let n=$(t).parents("tr"),e=n.find("td");if(!this.currentlyEditingRow(n))return;let i=!1;this._modifyEachColumn(this.options.editableColumns,e,(function(t){t.find("div").html()&&(i=!0)})),i?(this._modifyEachColumn(this.options.editableColumns,e,(function(t){let n=t.find("div").html();t.html(n)})),this._actionsModeNormal(t)):n.remove()}_actionAddRow(){let t=this.table.find("tbody tr"),n=this.table.find(".is-invalid").length>0,e=this.table.find("input").length>0;if(!n&&!e){if(0==t.length){let t=this.table.find("thead tr").find("th"),n="";t.each((function(){"bstable-actions"==$(this).attr("name")?n+='<td name="bstable-actions" style="vertical-align: initial; padding-top: .75rem"><div class="btn-group pull-right">\n    <button id="bEdit" name="bEdit" type="button" class="btn btn-sm btn-default">\n        <span class="fa fa-edit"> </span>\n    </button>\n    <button id="bDel" type="button" class="btn btn-sm btn-default">\n        <span class="fa fa-trash"> </span>\n    </button>\n    <button id="bAcep" type="button" class="btn btn-sm btn-default" style="display:none;">\n        <span class="fa fa-check-circle"> </span>\n    </button>\n    <button id="bCanc" type="button" class="btn btn-sm btn-default" style="display:none;">\n        <span class="fa fa-times-circle"> </span>\n    </button>\n</div></td>':n+="<td></td>"})),this.table.find("tbody").append("<tr>"+n+"</tr>")}else{let t=this.table.find("tr:last");t.clone().appendTo(t.parent()),t=this.table.find("tr:last"),t.find("td").each((function(){"bstable-actions"==$(this).attr("name")||$(this).html("")}))}this._addOnClickEventsToActions(),this.options.onAdd()}}_modifyEachColumn(t,n,e){let i=0;n.each((function(){i++,"bstable-actions"!=$(this).attr("name")&&function(n){if(null==t)return!0;for(let e=0;e<t.length;e++)if(n==t[e])return!0;return!1}(i-1)&&e($(this))}))}_addOnClickEventsToActions(){let t=this;this.table.find("tbody tr #bEdit").each((function(){let n=this;n.onclick=function(){t._rowEdit(n)}})),this.table.find("tbody tr #bDel").each((function(){let n=this;n.onclick=function(){t._rowDelete(n)}})),this.table.find("tbody tr #bAcep").each((function(){let n=this;n.onclick=function(){let e=!1;$(n).closest("tr").find("td").find("input").each((function(){$(this).hasClass("is-invalid")&&(e=!0),$(this).val()||$(this).addClass("is-invalid")})),e||t._rowAccept(n)}})),this.table.find("tbody tr #bCanc").each((function(){let n=this;n.onclick=function(){t._rowCancel(n)}}))}convertTableToCSV(t){let n=this,e="",i="";return n.table.find("tbody tr").each((function(){n.currentlyEditingRow($(this))&&$(this).find("#bAcep").click();let a=$(this).find("td");e="",a.each((function(){"bstable-actions"==$(this).attr("name")||(e=e+$(this).html()+t)})),""!=e&&(e=e.substr(0,e.length-t.length)),i=i+e+"\n"})),i}}
